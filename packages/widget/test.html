<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FreeFormAPI Widget Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 40px auto;
            padding: 20px;
        }

        form {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        input,
        textarea {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
        }

        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
        }

        button:disabled {
            background: #ccc;
        }

        .examples {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 40px;
        }
    </style>
</head>

<body>
    <h1>FreeFormAPI Widget Test</h1>

    <!-- В test.html добавь отладочную информацию -->
    <div id="freeform-debug"
        style="margin-top: 20px; padding: 10px; background: #f5f5f5; border-radius: 5px; font-family: monospace; font-size: 12px;">
        <h3>FreeFormAPI Debug</h3>
        <div id="session-info">Waiting for session...</div>
        <button onclick="checkHoneypot()">Check Honeypot Fields</button>
    </div>

    <script>
        // Отладочные функции
        function checkHoneypot() {
            const forms = document.querySelectorAll('form');
            forms.forEach((form, i) => {
                const inputs = Array.from(form.querySelectorAll('input'));
                const honeypots = inputs.filter(input => input.name.includes('_hp_'));
                console.log(`Form ${i}:`, honeypots.map(hp => ({ name: hp.name, value: hp.value })));
                alert(`Form ${i} has ${honeypots.length} honeypot fields`);
            });
        }

        // Автоматически показываем сессию
        setTimeout(() => {
            if (window.FreeFormAPI && window.FreeFormAPI.session) {
                document.getElementById('session-info').innerHTML = `
      Session ID: ${window.FreeFormAPI.session.sessionId}<br>
      Honeypot Field: ${window.FreeFormAPI.session.honeypotField}<br>
      Expires in: ${window.FreeFormAPI.session.expiresIn}s
    `;
            }
        }, 1000);
    </script>

    <h2>Форма обратной связи</h2>
    <form data-freeform="contact-form">
        <input type="email" name="email" placeholder="Ваш email" required>
        <textarea name="message" placeholder="Ваше сообщение" rows="4"></textarea>
        <button type="submit">Отправить</button>
    </form>

    <h2>Подписка на рассылку</h2>
    <form data-freeform="newsletter-form">
        <input type="email" name="email" placeholder="Email для рассылки" required>
        <button type="submit">Подписаться</button>
    </form>

    <div class="examples">
        <div>
            <h3>Использование виджета:</h3>
            <pre><code>&lt;script src="widget.js"&gt;&lt;/script&gt;
&lt;form data-freeform="my-form"&gt;
  &lt;input type="email" name="email" required&gt;
  &lt;button&gt;Отправить&lt;/button&gt;
&lt;/form&gt;</code></pre>
        </div>

        <div>
            <h3>Программное использование:</h3>
            <pre><code>&lt;script&gt;
// Ручная отправка
FreeFormAPI.submit('my-form', {
  email: 'user@example.com',
  message: 'Hello!'
}).then(console.log);
&lt;/script&gt;</code></pre>
        </div>
    </div>
    <script src="widget.js"></script>
    <script>
        // Можно настроить конфигурацию
        // FreeFormAPI.init({
        //     apiUrl: 'http://localhost:3000/api/submit',
        //     successMessage: 'Спасибо!'
        // });

    </script>
</body>

</html>